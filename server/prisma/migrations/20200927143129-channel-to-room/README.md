# Migration `20200927143129-channel-to-room`

This migration has been generated by Alaa Zorkane at 9/27/2020, 3:31:29 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Message" DROP CONSTRAINT "Message_channelId_fkey"

ALTER TABLE "public"."User" DROP CONSTRAINT "User_channelId_fkey"

ALTER TABLE "public"."Message" DROP COLUMN "channelId",
ADD COLUMN "roomId" text   

ALTER TABLE "public"."User" DROP COLUMN "channelId",
ADD COLUMN "roomId" text   

CREATE TABLE "public"."Room" (
"id" text   NOT NULL ,
"name" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
PRIMARY KEY ("id")
)

ALTER TABLE "public"."Message" ADD FOREIGN KEY ("roomId")REFERENCES "public"."Room"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "public"."User" ADD FOREIGN KEY ("roomId")REFERENCES "public"."Room"("id") ON DELETE SET NULL ON UPDATE CASCADE

DROP TABLE "public"."Channel"
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200912174409..20200927143129-channel-to-room
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
@@ -13,10 +13,10 @@
   username  String    @unique
   password  String
   createdAt DateTime  @default(now())
   updatedAt DateTime  @updatedAt
-  Channel   Channel?  @relation(fields: [channelId], references: [id])
-  channelId String?
+  Room      Room?     @relation(fields: [roomId], references: [id])
+  roomId    String?
   Message   Message[]
 }
 model Message {
@@ -24,14 +24,14 @@
   content   String
   user      User     @relation(fields: [userId], references: [id])
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
-  Channel   Channel? @relation(fields: [channelId], references: [id])
-  channelId String?
+  Room      Room?    @relation(fields: [roomId], references: [id])
+  roomId    String?
   userId    String
 }
-model Channel {
+model Room {
   id        String    @id @default(cuid())
   name      String
   members   User[]
   messages  Message[]
```


